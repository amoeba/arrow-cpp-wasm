<div>
  <label for="f">Choose file:</label>
  <input id="f" type="file" />
</div>

<script src="./a.out.js"></script>
<script>
  Module.onRuntimeInitialized = async () => {
    console.log("onRuntimeInitialized called");
  };

  document.getElementById('f').addEventListener('change', function(e) {
    if (!e.target.files[0]) {
      console.log("error, files array is empty...", e.target.files)
      return;
    }

    console.log("handling file...")
    var file = e.target.files[0];


     var fr = new FileReader()

     fr.onload = function () {
       var data = new Uint8Array(fr.result);

       let filename = 'tmp.arrow';
       let stream = FS.open(filename, 'w+');
       FS.write(stream, data, 0, data.length, 0);
       FS.close(stream);
//       Module['FS_createDataFile']('/', 'filename', data, true, true, true);
//       Module.ccall('main', null, [], null);
console.log("hi", Module);
console.log("hi", Module.ProcessFile(filename));

       e.target.value = '';
   };
   fr.readAsArrayBuffer(file);

  });
</script>
